# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4 - ZooKeeper üë®‚Äçüåæ
## –ó–∞–¥–∞–Ω–∏–µ
+ –∑–∞–ø—É—Å—Ç–∏—Ç—å ZooKeeper,
+ –∏–∑—É—á–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π ZooKeeper,
+ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é ZooKeeper CLI –∏ –æ—Å–≤–æ–∏—Ç—å –µ—ë –∫–æ–º–∞–Ω–¥—ã,
+ –Ω–∞—É—á–∏—Ç—å—Å—è –ø—Ä–æ–≤–æ–¥–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ZooKeeper,
+ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –±–∞—Ä—å–µ—Ä–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–π –Ω–∞ ZooKeeper,
+ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞: ```brew install zookeeper``` <br/>
<img src="/L4/images/install.png" width="500"> <br/>
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∂–µ: ```zkServer start``` <br/>
<img src="/L4/images/start.png" width="500">
## –ò–∑—É—á–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
–ü–µ—Ä–µ–π–¥–µ–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —É—Å—Ç–∞–Ω–æ–≤–∫–∏ ZooKeeper –∏ –∏–∑—É—á–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. <br/>
–í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞–ø–∫–∏:
+ bin —Å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞, –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å ZooKeeper,
+ conf —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏,
+ contrib —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ZooKeeper –≤ –¥—Ä—É–≥–∏–µ —Å–∏—Å—Ç–µ–º—ã: rest, fuse, perl –∏ python –±–∏–±–ª–∏–æ—Ç–µ–∫–∏,
+ dist-maven –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã Maven,
+ docs –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è,
+ recipes —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã, –ø–æ–º–æ–≥–∞—é—â–∏–µ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ZooKeeper (–≤—ã–±–æ—Ä –ª–∏–¥–µ—Ä–∞, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –æ—á–µ—Ä–µ–¥–∏),
+ src —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ —Å–∫—Ä–∏–ø—Ç–∞–º–∏.

## –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ ZooKeeper CLI, –æ—Å–≤–æ–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ ZooKeeper CLI –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∫—Ä–∏–ø—Ç zkCli.
–°–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ZooKeeper CLI —Å–µ—Å—Å–∏–∏: <br/>
<img src="/L4/images/zkCli.png" width="500"> <br/>
–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ. –î–ª—è –≤—ã–≤–æ–¥–∞ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –Ω–∞–±–µ—Ä–µ–º ```help```:
<img src="/L4/images/help.png" width="500"> <br/>
–î–∞–ª–µ–µ –ø–æ—Å–ª–µ–¥—É–µ—Ç –∏–∑—É—á–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –ù–∞—É—á–∏–º—Å—è –¥–æ–±–∞–≤–ª—è—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —É–∑–ª–æ–≤ znode, —Å—á–∏—Ç—ã–≤–∞—Ç—å –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ znode –∏–∑ CLI, —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ –Ω–∞ –±–∞–∑–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö.
–ù–∞—Ö–æ–¥—è—Å—å –≤ –∫–æ–Ω—Å–æ–ª–∏ CLI –≤–≤–µ–¥–µ–º –∫–æ–º–∞–Ω–¥—É ```ls /```.
–í —Ä–µ–∑—É–ª—å—Ç–µ –ø–æ–ª—É—á–∏–º —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤ –≤ –∫–æ—Ä–Ω–µ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö ZooKeeper. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –æ–¥–∏–Ω —É–∑–µ–ª. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–æ–∂–Ω–æ –∏–∑—É—á–∞—Ç—å –Ω–µ–∫–æ—Ä–Ω–µ–≤—ã–µ —É–∑–ª—ã. –í—ã–≤–µ–¥–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ—á–µ—Ä–Ω–∏—Ö —É–∑–ª–æ–≤ ```/zookeeper```: <br/>
<br/>
<img src="/L4/images/ls_zookeeper.png" width="500"> <br/>
–¢–µ–ø–µ—Ä—å –≤ –∫–æ—Ä–Ω–µ —Å–æ–∑–¥–∏–º —Å–≤–æ–π —É–∑–µ–ª ```/mynode``` —Å –¥–∞–Ω–Ω—ã–º–∏ ```"first_version"``` —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–∞–Ω–¥–æ–π ```create /mynode 'first_version'```.
–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤ –∫–æ—Ä–Ω–µ –ø–æ—è–≤–∏–ª—Å—è –Ω–æ–≤—ã–π —É–∑–µ–ª: <br/>
<br/>
<img src="/L4/images/create_my_node.png" width="500"> <br/>
–ò–∑–º–µ–Ω–∏–º –¥–∞–Ω–Ω—ã–µ —É–∑–ª–∞ –Ω–∞ ```"second_version"```: <br/>
<br/>
<img src="/L4/images/second_version.png" width="500"> <br/>
–°–æ–∑–¥–∞–¥–∏–º –¥–≤–∞ –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã—Ö (sequential) —É–∑–ª–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ—á–µ—Ä–Ω–∏—Ö ```mynode```: <br/>
<br/>
<img src="/L4/images/childs.png" width="500"> <br/>

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –∑–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
1. –†–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –æ–±–µ–¥–∞—é—â–∏—Ö —Ñ–∏–ª–æ—Å–æ—Ñ–æ–≤ <br/>
–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è :
```scala
Philosopher 2 is going to eat
Philosopher 1 is going to eat
Philosopher 0 is going to eat
Philosopher 0 picked up the left fork
Philosopher 0 picked up the right fork
Philosopher 0 put the right fork
Philosopher 1 picked up the left fork
Philosopher 1 picked up the right fork
Philosopher 0 put the loft fork and finished eating
Philosopher 0 is thinking
Philosopher 2 picked up the left fork
Philosopher 1 put the right fork
Philosopher 1 put the loft fork and finished eating
Philosopher 2 picked up the right fork
Philosopher 1 is thinking
Philosopher 0 is going to eat
Philosopher 1 is going to eat
Philosopher 0 picked up the left fork
Philosopher 2 put the right fork
Philosopher 0 picked up the right fork
Philosopher 2 put the loft fork and finished eating
Philosopher 2 is thinking
Philosopher 1 picked up the left fork
Philosopher 0 put the right fork
Philosopher 1 picked up the right fork
Philosopher 0 put the loft fork and finished eating
Philosopher 0 is thinking
Philosopher 1 put the right fork
Philosopher 1 put the loft fork and finished eating
Philosopher 1 is thinking
Philosopher 2 is going to eat
Philosopher 2 picked up the left fork
Philosopher 2 picked up the right fork
Philosopher 2 put the right fork
Philosopher 2 put the loft fork and finished eating
Philosopher 2 is thinking

Process finished with exit code 0
```
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–≤—É—Ñ–∞–∑–Ω—ã–π –∫–æ–º–º–∏—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è high-available —Ä–µ–≥–∏—Å—Ç—Ä <br/>
–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
```python
Waiting others clients: []
Client 1 request abort
Client 3 request commit
Client 0 request abort
Client 2 request abort
Client 4 request commit
Check clients
Client 0 do abort
Client 1 do abort
Client 2 do abort
Client 3 do abort
Client 4 do abort
Waiting others clients: []
```
